---
phase: 01-foundation-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - vite.config.ts
  - index.html
  - src/main.ts
  - src/vite-env.d.ts
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "npm install completes without errors"
    - "npm run dev starts Vite dev server"
    - "Browser shows empty Phaser canvas at localhost:5173"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies including Phaser 3.90+ and Firebase 11+"
      contains: "phaser"
    - path: "tsconfig.json"
      provides: "TypeScript config with strictPropertyInitialization: false for Phaser"
      contains: "strictPropertyInitialization"
    - path: "vite.config.ts"
      provides: "Vite configuration"
    - path: "src/main.ts"
      provides: "Application entry point"
    - path: "index.html"
      provides: "HTML shell with game-container div"
      contains: "game-container"
  key_links:
    - from: "index.html"
      to: "src/main.ts"
      via: "script module import"
      pattern: "type=\"module\""
---

<objective>
Set up the KLO Match-3 project scaffold using the official Phaser + TypeScript + Vite template, then add Firebase dependencies.

Purpose: This creates the foundation that all subsequent plans build upon. Without a working dev environment, no other work can proceed.

Output: A minimal runnable Phaser project with Firebase SDK installed, ready for game code and Firebase integration.
</objective>

<execution_context>
@/Users/vasiliyhrebenuyk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vasiliyhrebenuyk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-setup/01-RESEARCH.md

Key decisions from research:
- Use official phaserjs/template-vite-ts pattern (Phaser 3.90.0, TypeScript 5.7.2, Vite 6.3.1)
- Firebase v11 modular SDK
- strictPropertyInitialization: false in tsconfig for Phaser
- Public folder for Phaser assets, imports for bundled code
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize project with Phaser + Vite + TypeScript</name>
  <files>
    - package.json
    - tsconfig.json
    - vite.config.ts
    - index.html
    - src/main.ts
    - src/vite-env.d.ts
    - .gitignore
  </files>
  <action>
Create the project scaffold manually (not cloning template, as we have existing files in repo).

1. Create package.json with:
   - name: "klo-match-3"
   - type: "module"
   - scripts: dev, build, preview
   - dependencies: phaser@^3.90.0, firebase@^11.0.0
   - devDependencies: typescript@^5.7.0, vite@^6.0.0

2. Create tsconfig.json with Phaser-compatible settings:
   - target: ES2020
   - module: ES2020
   - moduleResolution: bundler
   - strict: true
   - strictPropertyInitialization: false (CRITICAL for Phaser)
   - skipLibCheck: true
   - esModuleInterop: true
   - include: ["src"]

3. Create vite.config.ts:
   - Basic config with build outDir: "dist"
   - Server port 5173

4. Create index.html in project root:
   - DOCTYPE html with viewport meta
   - div#game-container for Phaser
   - Script module pointing to /src/main.ts
   - Basic styles: body margin 0, overflow hidden

5. Create src/main.ts:
   - Minimal Phaser game config
   - Single empty scene (placeholder)
   - Parent: 'game-container'
   - Width: 1024, Height: 768
   - Background: #F9F9F9 (KLO off-white)
   - Scale mode: FIT, center: CENTER_BOTH

6. Create src/vite-env.d.ts:
   - Triple-slash reference to vite/client types

7. Update .gitignore:
   - Add node_modules/, dist/, .env.local, .env.*.local
   - Keep .env (it already exists with Firebase config)
  </action>
  <verify>
Run: npm install && npm run dev
Expected: No errors, dev server starts on localhost:5173
  </verify>
  <done>
Vite dev server runs, browser shows Phaser canvas (off-white 1024x768 rectangle).
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure project structure directories</name>
  <files>
    - src/scenes/.gitkeep
    - src/game/.gitkeep
    - src/firebase/.gitkeep
    - src/data/.gitkeep
    - src/utils/constants.ts
    - public/assets/.gitkeep
    - public/data/levels/.gitkeep
  </files>
  <action>
Create the directory structure per TECH_SPEC.md:

1. Create directories with .gitkeep files:
   - src/scenes/
   - src/game/
   - src/firebase/
   - src/data/
   - src/utils/
   - public/assets/
   - public/assets/tiles/
   - public/assets/ui/
   - public/assets/backgrounds/
   - public/data/levels/

2. Create src/utils/constants.ts with game constants:
   - GRID_WIDTH: 8
   - GRID_HEIGHT: 8
   - TILE_SIZE: 64
   - GAME_WIDTH: 1024
   - GAME_HEIGHT: 768
   - KLO_YELLOW: 0xFFB800
   - KLO_BLACK: 0x1A1A1A
   - KLO_WHITE: 0xF9F9F9

3. Copy level JSON files from data/levels/ to public/data/levels/:
   - level_001.json through level_005.json
   - These will be loaded by Phaser at runtime
  </action>
  <verify>
Run: ls -la src/scenes src/game src/firebase src/data src/utils public/assets public/data/levels
Expected: All directories exist, constants.ts exists, level JSON files copied
  </verify>
  <done>
Project structure matches TECH_SPEC.md architecture. Level data available in public folder for Phaser loading.
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. Run `npm run dev` - should start without errors
2. Open http://localhost:5173 - should show Phaser canvas
3. Check browser console - no errors
4. Verify directory structure matches TECH_SPEC.md
5. Run `npm run build` - should produce dist/ folder
</verification>

<success_criteria>
- npm install succeeds
- npm run dev starts Vite on localhost:5173
- Browser shows 1024x768 off-white Phaser canvas
- Project structure matches TECH_SPEC.md
- No TypeScript or runtime errors
- Firebase SDK installed (but not yet initialized)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-setup/01-01-SUMMARY.md`
</output>
